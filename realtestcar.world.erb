<?xml version="1.0" ?>
<%
    grid = 5
    n = 0
    block = 55
    asphalt_positions = []
    while n < grid
        asphalt_positions << block
        block = block + 100
        n = n + 1
    end

%>

<sdf version="1.5">
  <world name="default">
    <gui>
      <camera name="user_camera">
        <pose>7 -3 2.5 0 0.27 2.35</pose>
      </camera>
    </gui>
    <include>
       <uri>models/ground_plane</uri>
    </include>
    <include>
      <uri>model://sun</uri>
    </include>
    <include>
        <uri>/models/sdcCar</uri>
        <pose>105 205 0 0 0 0</pose>
    </include>


<%   # Asphalt Planes
   x = -1
   y = 0
   while y < grid
       x = x + 1
       if x == grid
           if y == grid - 1
               break
           end
           x = 0
           y = y + 1
       end
       name = 'asphalt_plane_' + x.to_s + '_' + y.to_s
%>

  <%="<model name='#{name}'>" %>
    <pose><%= asphalt_positions[x]%> <%= asphalt_positions[y]%> 0 0 0 0</pose>
    <static>true</static>
    <link name="link">
      <collision name="collision">
        <geometry>
          <box>
            <size>90 90 3</size>
          </box>
        </geometry>
      </collision>
      <visual name="visual">
        <cast_shadows>false</cast_shadows>
        <geometry>
          <box>
            <size>90 90 3</size>
          </box>
        </geometry>
        <material>
          <script>
            <uri>models/asphalt_plane/materials/scripts</uri>
            <uri>models/asphalt_plane/materials/textures</uri>
            <name>vrc/asphalt</name>
          </script>
        </material>
      </visual>
    </link>
  </model>
<%  end %>

<%    #Roads
    x = -1
    y = 0
    while y < grid
        x = x + 1
        if x == grid
            if y == grid - 1
                break
            end
            x = 0
            y = y + 1
        end
        name1 = 'road_1_' + x.to_s + '_' + y.to_s
        name2 = 'road_2_' + x.to_s + '_' + y.to_s
        name3 = 'intersection_' + x.to_s + '_' + y.to_s
%>

    <%="<road name='#{name1}'>" %>
        <width>10</width>
        <point><%= asphalt_positions[x]-50%> <%= asphalt_positions[y]-45%> .005</point>
        <point><%= asphalt_positions[x]-50%> <%= asphalt_positions[y]+45%> .005</point>
    </road>
    <%="<road name='#{name2}'>" %>
        <width>10</width>
        <point><%= asphalt_positions[x]-45%> <%= asphalt_positions[y]-50%> .005</point>
        <point><%= asphalt_positions[x]+45%> <%= asphalt_positions[y]-50%> .005</point>
    </road>
    <%="<road name='#{name3}'>" %>
        <width>10</width>
        <point><%= asphalt_positions[x]-55%> <%= asphalt_positions[y]-50%> .005</point>
        <point><%= asphalt_positions[x]-45%> <%= asphalt_positions[y]-50%> .005</point>
        <material>
            <script>
                <uri>file://media/materials/scripts/gazebo.material</uri>
                <name>Gazebo/Footway</name>
            </script>
        </material>
    </road>
<%  end %>

  </world>
</sdf>
